<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>YouTube Playlist Player</title>
  <style>
    /* Reset Î³Î¹Î± conflicts */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100% );
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
    }
    
    .main-container {
      width: 100%;
      max-width: 1100px;
      margin: 20px auto;
      padding: 15px;
    }
    
    .player-wrapper {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 550px;
      max-height: 75vh;
      background: #fff;
      border: 2px solid #ddd;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      overflow: hidden;
    }
    
    .video-section {
      flex: 2;
      background-color: #000;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }
    
    .player-screen {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #111;
      min-height: 0;
      overflow: hidden;
      /* -- Î”Î™ÎŸÎ¡Î˜Î©Î£Î— 1: Î£Ï„Î±Î¸ÎµÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… player -- */
      position: relative;
    }
    
    #player {
      /* -- Î”Î™ÎŸÎ¡Î˜Î©Î£Î— 1: Î£Ï„Î±Î¸ÎµÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… player -- */
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .player-controls {
      background: linear-gradient(to right, #2c3e50, #4a6491);
      color: white;
      padding: 12px 15px;
      display: flex;
      justify-content: center;
      gap: 25px;
      border-top: 3px solid #3498db;
      flex-shrink: 0;
      min-height: 60px;
    }
    
    .player-controls button {
      background: #2980b9;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      min-width: 150px;
      justify-content: center;
      height: 45px;
    }
    
    .player-controls button:hover {
      background: #3498db;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }
    
    .playlist-section {
      flex: 1;
      padding: 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
      background: #f8f9fa;
      border-left: 3px solid #e0e0e0;
      min-height: 0;
    }
    
    .playlist-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: linear-gradient(135deg, #1a2980, #26d0ce);
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      border-bottom: 3px solid rgba(255, 255, 255, 0.2);
      min-height: 75px;
      flex-shrink: 0;
      overflow: hidden;
    }
    
    .playlist-header:hover {
      background: linear-gradient(135deg, #162570, #21b9b7);
    }
    
    .playlist-info {
        flex: 1;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        padding-right: 10px;
        display: flex;
        align-items: center;
    }

    /* -- Î”Î™ÎŸÎ¡Î˜Î©Î£Î— 2: Î£Ï„Ï…Î» Î³Î¹Î± Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Î´Î¯Ï€Î»Î± ÏƒÏ„Î¿Î½ Ï„Î¯Ï„Î»Î¿ -- */
    #current-playlist-icon {
        width: 28px;
        height: 28px;
        margin-right: 12px;
        border-radius: 5px;
        object-fit: cover;
        flex-shrink: 0;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .playlist-info-text {
        overflow: hidden;
    }

    .playlist-info h2 {
      margin: 0 0 5px 0;
      font-size: 18px;
      font-weight: bold;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .playlist-info p {
      margin: 0;
      font-size: 13px;
      opacity: 0.9;
    }
    /* Î•Î½ÎµÏÎ³Î® playlist â€“ Ï€Î»Î®ÏÎ·Ï‚ Ï„Î¯Ï„Î»Î¿Ï‚ */
    .playlist-header.full-title .playlist-info {
       white-space: normal;
      overflow: visible;
    }

    .playlist-header.full-title .playlist-info h2 {
      white-space: normal;
      overflow: visible;
      text-overflow: unset;
      line-height: 1.3;
      max-height: 2.6em;
    }
	
    .change-playlist-btn {
      background: rgba(255, 255, 255, 0.25);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.4);
      padding: 8px 16px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 13px;
      font-weight: bold;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
      height: 36px;
      flex-shrink: 0;
    }
    
    .change-playlist-btn:hover {
      background: rgba(255, 255, 255, 0.35);
      transform: scale(1.05);
    }
    
    .playlist-drawer {
      position: absolute;
      top: 0;
      right: -100%;
      width: 100%;
      height: 100%;
      background: white;
      padding: 20px;
      transition: right 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      z-index: 100;
      box-shadow: -8px 0 25px rgba(0,0,0,0.15);
      overflow-y: auto;
    }
    
    .playlist-drawer.active {
      right: 0;
    }
    
    .drawer-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 3px solid #1a2980;
    }
    
    .drawer-top h3 {
      margin: 0;
      color: #1a2980;
      font-size: 20px;
    }
    
    .close-drawer-btn {
      background: #e74c3c;
      color: white;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    
    .close-drawer-btn:hover {
      background: #c0392b;
      transform: rotate(90deg);
    }
    
    .playlist-options {
      margin-top: 15px;
    }
    
    .playlist-option {
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 15px;
      overflow: hidden;
    }
    
    .playlist-option:hover {
      border-color: #1a2980;
      background: #f0f8ff;
      transform: translateX(10px);
    }
    
    .playlist-option.active {
      border-color: #1a2980;
      background: #e8f4fc;
      box-shadow: 0 5px 15px rgba(26, 41, 128, 0.1);
    }
    
    .playlist-icon {
      font-size: 24px;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1a2980, #26d0ce);
      color: white;
      border-radius: 10px;
      flex-shrink: 0;
    }
    
    .playlist-details {
        flex: 1;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

    .playlist-details h4 {
      margin: 0 0 5px 0;
      color: #2c3e50;
      font-size: 16px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .playlist-details p {
      margin: 0;
      color: #7f8c8d;
      font-size: 12px;
      font-family: monospace;
    }
    
    .songs-container {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: white;
      -webkit-overflow-scrolling: touch !important;
      min-height: 0;
    }
    
    .songs-container h3 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      font-size: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid #eee;
    }
    
    .songs-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .song-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
      transition: all 0.3s;
      border-radius: 8px;
      margin-bottom: 6px;
      -webkit-tap-highlight-color: transparent;
      overflow: hidden;
    }
    
    .song-item:hover {
      background-color: #f8f9fa;
      transform: translateX(5px);
    }
    
    .song-item.active {
      background-color: #e3f2fd;
      border-left: 4px solid #2196f3;
      font-weight: bold;
      scroll-margin-top: 20px;
    }
    
    .song-thumb {
      width: 80px;
      height: 55px;
      object-fit: cover;
      border-radius: 6px;
      flex-shrink: 0;
      border: 2px solid #ddd;
    }
    
    .song-title {
      flex: 1;
      font-size: 13px;
      color: #34495e;
      line-height: 1.4;
      white-space: normal;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    @media (min-width: 769px) and (max-height: 800px) {
      .player-wrapper { height: 500px; max-height: 85vh; }
      .player-controls { padding: 10px 15px; min-height: 55px; }
      .player-controls button { padding: 8px 16px; font-size: 14px; min-width: 140px; height: 40px; }
      .playlist-header { padding: 12px 15px; min-height: 65px; }
      .playlist-info h2 { font-size: 16px; }
      .song-item { padding: 10px; }
      .song-thumb { width: 70px; height: 50px; }
    }
    
    @media (min-width: 769px) and (max-height: 700px) {
      .player-wrapper { height: 450px; }
      .main-container { margin: 10px auto; padding: 10px; }
    }
    
    @media (max-width: 1024px) {
      .player-wrapper { height: 500px; }
      .player-controls button { min-width: 130px; padding: 10px 15px; }
    }
    
    @media (max-width: 768px) {
      .main-container { padding: 10px; height: 100vh !important; max-height: -webkit-fill-available !important; }
      .player-wrapper { flex-direction: column; height: 100% !important; max-height: 100% !important; min-height: 0 !important; overflow: hidden !important; }
      .video-section { height: 45vh !important; min-height: 45vh !important; max-height: 45vh !important; flex-shrink: 0 !important; }
      .playlist-section { height: 55vh !important; min-height: 55vh !important; flex: 1 !important; overflow: hidden !important; display: flex !important; flex-direction: column !important; }
      .playlist-header { padding: 12px 15px; min-height: 65px; flex-shrink: 0 !important; }
      .playlist-info h2 { font-size: 16px; }
      .playlist-info p { font-size: 12px; }
      .change-playlist-btn { padding: 7px 14px; font-size: 12px; height: 34px; }
      .player-controls { flex-direction: row; flex-wrap: wrap; gap: 10px; padding: 10px; flex-shrink: 0 !important; min-height: 55px; }
      .player-controls button { min-width: 110px; padding: 8px 12px; font-size: 13px; height: 38px; }
      .song-item { padding: 10px; gap: 10px; }
      .song-thumb { width: 65px; height: 45px; }
      .song-title { font-size: 12px; }
      .songs-container { overflow-y: scroll !important; -webkit-overflow-scrolling: touch !important; flex: 1 !important; min-height: 0 !important; padding: 12px; }
      .songs-container h3 { font-size: 15px; margin-bottom: 12px; }
    }
    
    @media (max-width: 480px) {
      .main-container { padding: 5px !important; margin: 5px auto !important; }
      .video-section { height: 40vh !important; }
      .playlist-section { height: 60vh !important; }
      .playlist-drawer { padding: 15px; }
      .playlist-option { padding: 12px; gap: 12px; }
      .playlist-icon { width: 40px; height: 40px; font-size: 20px; }
      .playlist-details h4 { font-size: 15px; }
      .player-controls button { min-width: 100px; padding: 7px 10px; font-size: 12px; height: 35px; }
      .songs-container { padding: 10px !important; }
    }
    
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #555; }
    
    body { -webkit-text-size-adjust: 100%; touch-action: pan-y; }
    
    @media (min-height: 900px) { .player-wrapper { height: 600px; } }
    @media (min-height: 1080px) { .player-wrapper { height: 650px; } }
    
    .playlist-custom-icon { width: 45px; height: 45px; border-radius: 10px; object-fit: cover; flex-shrink: 0; background: linear-gradient(135deg, #1a2980, #26d0ce); padding: 5px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; }
    .playlist-custom-icon.fallback { background: linear-gradient(135deg, #1a2980, #26d0ce); color: white; font-size: 24px; }
    .playlist-option img.playlist-custom-icon { background: none; padding: 0; border: 2px solid #1a2980; }
    
    @media (max-width: 768px) {
      .playlist-custom-icon { width: 40px; height: 40px; }
      .playlist-custom-icon.fallback { font-size: 20px; }
    }
	
	/* Playlist drawer â€“ Ï€Î»Î®ÏÎ·Ï‚ Ï„Î¯Ï„Î»Î¿Ï‚ Î¼Îµ Î±Î½Î±Î´Î¯Ï€Î»Ï‰ÏƒÎ· */
    .playlist-drawer .playlist-details {
       white-space: normal;
       overflow: visible;
    }

   .playlist-drawer .playlist-details h4 {
      white-space: normal;
      overflow: visible;
      text-overflow: unset;
      line-height: 1.35;
    }
	
  </style>
</head>
<body>
  <div class="main-container">
    <div class="player-wrapper">
      <div class="video-section">
        <div class="player-screen">
          <div id="player"></div>
        </div>
        <div class="player-controls">
          <button onclick="playPrevVideo()">
            <span>â®</span> Î ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿
          </button>
          <button onclick="playNextVideo()">
            <span>â­</span> Î•Ï€ÏŒÎ¼ÎµÎ½Î¿
          </button>
        </div>
      </div>
      
      <div class="playlist-section">
        <div class="playlist-header" id="playlist-header" onclick="openPlaylistDrawer()">
          <div class="playlist-info">
            <!-- -- Î”Î™ÎŸÎ¡Î˜Î©Î£Î— 2: Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Ï„Î¿Ï… img element Î³Î¹Î± Ï„Î¿ ÎµÎ¹ÎºÎ¿Î½Î¯Î´Î¹Î¿ -- -->
            <div id="current-playlist-icon" class="playlist-icon fallback"></div>
            <div class="playlist-info-text">
                <h2 id="current-playlist-title">ğŸµ Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Playlist</h2>
                <p id="current-playlist-count">ÎšÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº Î³Î¹Î± ÎµÏ€Î¹Î»Î¿Î³Î®</p>
            </div>
          </div>
          <button class="change-playlist-btn" onclick="event.stopPropagation(); openPlaylistDrawer()">
            <span>ğŸ”„</span> Î‘Î»Î»Î±Î³Î®
          </button>
        </div>
        
        <div class="playlist-drawer" id="playlist-drawer">
          <div class="drawer-top">
            <h3>ğŸ“‚ Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ Playlists</h3>
            <button class="close-drawer-btn" onclick="closePlaylistDrawer()">âœ•</button>
          </div>
          <div class="playlist-options" id="playlist-options"></div>
        </div>
        
        <div class="songs-container">
          <h3>ğŸµ Î¤ÏÎ±Î³Î¿ÏÎ´Î¹Î±</h3>
          <ul class="songs-list" id="songs-list"></ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    window.addEventListener('DOMContentLoaded', function() {
      console.log('YouTube Playlist Player loading...');
      initializePlayer();
      enableMobileScrolling();
      preventPageScroll();
    });
    
    let youtubePlayer;
    let currentPlaylist = [];
    let currentVideoIndex = 0;
    let currentPlaylistId = '';
    let isLastVideoEnded = false;
    
    const YOUTUBE_API_KEY = 'AIzaSyAs1Tvv4WEzmBIMQrImnnC4LqHcHhspAZY'; 
    
    // Î‘ÎÎ¤Î™ÎšÎ‘Î¤Î‘Î£Î¤Î‘Î£Î—: Î‘Ï†Î±Î¯ÏÎµÏƒÎµ Ï„Î¿Î½ ÏƒÏ„Î±Ï„Î¹ÎºÏŒ Ï€Î¯Î½Î±ÎºÎ± ÎºÎ±Î¹ Î²Î¬Î»Îµ Î±Ï…Ï„ÏŒ:
    let availablePlaylists = []; // Î‘ÏÏ‡Î¹ÎºÎ¬ Î¬Î´ÎµÎ¹Î¿, Î¸Î± Î³ÎµÎ¼Î¯ÏƒÎµÎ¹ Î±Ï€ÏŒ fetch

    let fetchedPlaylists = [];
   
    function preventPageScroll( ) {
      document.querySelectorAll('.player-controls button').forEach(button => {
        button.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
        });
      });
    }
    
    function enableMobileScrolling() {
      const songsContainer = document.querySelector('.songs-container');
      if (songsContainer) {
        songsContainer.style.touchAction = 'pan-y';
        songsContainer.style.webkitOverflowScrolling = 'touch';
      }
    }
    
async function initializePlayer() {
  loadYouTubeAPI();
  
  // Î Î¡ÎŸÎ£Î˜Î—ÎšÎ—: Î¦ÏŒÏÏ„Ï‰ÏƒÎµ Ï€ÏÏÏ„Î± Ï„Î¹Ï‚ playlists Î±Ï€ÏŒ Ï„Î¿ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿
  try {
    const response = await fetch('https://raw.githubusercontent.com/myrovolistisgr/YT-playlists-player/main/playlists.json');
    const data = await response.json();
    availablePlaylists = data.playlists || [];
  } catch (error) {
    console.error('Î£Ï†Î¬Î»Î¼Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ playlists:', error);
    // Fallback ÏƒÎµ ÎºÎµÎ½Î® Î»Î¯ÏƒÏ„Î± Î±Î½ Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹
    availablePlaylists = [];
  }
  
  // Î£Ï…Î½Î­Ï‡ÎµÎ¹Î± ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ¹Î½
  await fetchAllPlaylistDetails();
  renderPlaylistOptions();
  
  if (fetchedPlaylists.length > 0) {
    selectPlaylist(fetchedPlaylists[0]);
  }
}

    async function fetchAllPlaylistDetails() {
        const promises = availablePlaylists.map(async (p) => {
            const url = `https://www.googleapis.com/youtube/v3/playlists?part=snippet&id=${p.id}&key=${YOUTUBE_API_KEY}`;
            try {
                const response = await fetch(url );
                const data = await response.json();
                if (data.items && data.items.length > 0) {
                    return { ...p, name: data.items[0].snippet.title };
                }
                return { ...p, name: "Î†Î³Î½Ï‰ÏƒÏ„Î· Playlist" };
            } catch (error) {
                console.error(`Î£Ï†Î¬Î»Î¼Î± Î±Î½Î¬ÎºÏ„Î·ÏƒÎ·Ï‚ Î³Î¹Î± playlist ${p.id}:`, error);
                return { ...p, name: "Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î¦ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚" };
            }
        });
        fetchedPlaylists = await Promise.all(promises);
    }
    
    function loadYouTubeAPI() {
      if (window.YT && window.YT.Player) {
        createYouTubePlayer();
        return;
      }
      const tag = document.createElement('script');
      tag.src = 'https://www.youtube.com/iframe_api';
      const firstScriptTag = document.getElementsByTagName('script' )[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      window.onYouTubeIframeAPIReady = function() {
        createYouTubePlayer();
      };
    }
    
    function createYouTubePlayer() {
      youtubePlayer = new YT.Player('player', {
        height: '100%',
        width: '100%',
        videoId: '',
        events: {
          onReady: (event) => {
              // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Î¿Ï… Ï€ÏÏÏ„Î¿Ï… Î²Î¯Î½Ï„ÎµÎ¿ Ï„Î·Ï‚ Î±ÏÏ‡Î¹ÎºÎ®Ï‚ playlist ÏŒÏ„Î±Î½ Î¿ player ÎµÎ¯Î½Î±Î¹ Î­Ï„Î¿Î¹Î¼Î¿Ï‚
              if (currentPlaylist.length > 0) {
                  youtubePlayer.loadVideoById(currentPlaylist[0].videoId);
                  youtubePlayer.stopVideo();
              }
          },
          onStateChange: (event) => {
            if (event.data === YT.PlayerState.ENDED) {
              if (currentVideoIndex === currentPlaylist.length - 1) {
                isLastVideoEnded = true;
              } else {
                setTimeout(playNextVideo, 100);
              }
            }
            if (event.data === YT.PlayerState.PLAYING) isLastVideoEnded = false;
          },
          onError: (error) => {
            console.error('YouTube Player error:', error);
            if (currentVideoIndex < currentPlaylist.length - 1) playNextVideo();
          }
        },
        playerVars: { autoplay: 0, controls: 1, rel: 0, modestbranding: 1, fs: 1 }
      });
    }
    
    function renderPlaylistOptions() {
      const container = document.getElementById('playlist-options');
      container.innerHTML = '';
      fetchedPlaylists.forEach(playlist => {
        const option = document.createElement('div');
        option.className = `playlist-option ${playlist.id === currentPlaylistId ? 'active' : ''}`;
        option.onclick = () => selectPlaylist(playlist);
        
        let iconHTML = (playlist.iconType === 'image')
          ? `<div class="playlist-icon"><img src="${playlist.icon}" alt="${playlist.name}" class="playlist-custom-icon" onerror="this.onerror=null; this.parentElement.innerHTML='${playlist.fallback || 'ğŸ“'}'; this.parentElement.className='playlist-icon fallback'"></div>`
          : `<div class="playlist-icon">${playlist.icon}</div>`;
        
        option.innerHTML = `${iconHTML}<div class="playlist-details"><h4>${playlist.name}</h4><p>ID: ${playlist.id.substring(0, 12)}...</p></div>`;
        container.appendChild(option);
      });
    }
    
    function openPlaylistDrawer() {
      document.getElementById('playlist-drawer').classList.add('active');
      renderPlaylistOptions();
    }
    
    function closePlaylistDrawer() {
      document.getElementById('playlist-drawer').classList.remove('active');
    }
    
    function selectPlaylist(playlist) {
      currentPlaylistId = playlist.id;
      isLastVideoEnded = false;
      
      // -- Î”Î™ÎŸÎ¡Î˜Î©Î£Î— 2 & 3: Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Î¯Ï„Î»Î¿Ï…, ÎµÎ¹ÎºÎ¿Î½Î¹Î´Î¯Î¿Ï… ÎºÎ±Î¹ Ï„Î¯Ï„Î»Î¿Ï… ÎºÎ±ÏÏ„Î­Î»Î±Ï‚ --
      document.getElementById('current-playlist-title').textContent = playlist.name;
      document.title = playlist.name; // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Î¯Ï„Î»Î¿Ï… ÎºÎ±ÏÏ„Î­Î»Î±Ï‚ browser
      document
        .getElementById('playlist-header')
        .classList.add('full-title');
      const iconElement = document.getElementById('current-playlist-icon');

      if (playlist.iconType === 'image') {
          iconElement.innerHTML = `
          <img src="${playlist.icon}"
          alt="${playlist.name}"
          class="playlist-custom-icon"
          onerror="this.onerror=null; this.parentElement.textContent='${playlist.fallback || 'ğŸµ'}'">
      `;
       } else {
       iconElement.textContent = playlist.icon || 'ğŸµ';
    }

      document.getElementById('current-playlist-count').textContent = 'Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...';
      closePlaylistDrawer();
      loadPlaylistFromYouTube(playlist.id);
    }
    
    function loadPlaylistFromYouTube(playlistId) {
    const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${YOUTUBE_API_KEY}`;
    fetch(url )
        .then(response => response.json())
        .then(data => {
            currentPlaylist = (data.items && data.items.length > 0) ? data.items.map(item => ({
                title: item.snippet.title,
                videoId: item.snippet.resourceId.videoId,
                thumbnail: item.snippet.thumbnails?.medium?.url || item.snippet.thumbnails?.default?.url || ''
            })) : [];
            currentVideoIndex = 0;
            renderSongsList();
            updatePlaylistHeader();
            if (youtubePlayer && youtubePlayer.cueVideoById) { // Changed from loadVideoById
                if (currentPlaylist.length > 0) {
                    youtubePlayer.cueVideoById(currentPlaylist[0].videoId); // Changed from loadVideoById
                } else {
                    youtubePlayer.stopVideo();
                    youtubePlayer.clearVideo();
                }
            }
        })
        .catch(error => {
            console.error('Î£Ï†Î¬Î»Î¼Î± Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ playlist:', error);
            currentPlaylist = [];
            renderSongsList();
            updatePlaylistHeader();
        });
}
    
    function updatePlaylistHeader() {
      const countElement = document.getElementById('current-playlist-count');
      countElement.textContent = (currentPlaylist.length > 0) ? `${currentPlaylist.length} Ï„ÏÎ±Î³Î¿ÏÎ´Î¹Î±` : 'ÎšÎµÎ½Î® playlist';
      countElement.style.color = (currentPlaylist.length > 0) ? 'white' : '#ffcccc';
    }
    
    function renderSongsList() {
      const list = document.getElementById('songs-list');
      list.innerHTML = '';
      document.querySelector('.songs-container').scrollTop = 0;
      
      currentPlaylist.forEach((song, index) => {
        const listItem = document.createElement('li');
        listItem.className = `song-item ${index === currentVideoIndex ? 'active' : ''}`;
        listItem.onclick = () => playVideo(song.videoId, index);
        listItem.innerHTML = `<img class="song-thumb" src="${song.thumbnail}" alt="" loading="lazy"><div class="song-title">${index + 1}. ${song.title}</div>`;
        list.appendChild(listItem);
      });
      updateActiveSongItem();
    }
    
    function playVideo(videoId, index) {
      currentVideoIndex = index;
      isLastVideoEnded = false;
      if (youtubePlayer && typeof youtubePlayer.loadVideoById === 'function') {
        youtubePlayer.loadVideoById(videoId);
      }
      updateActiveSongItem();
    }

    function updateActiveSongItem() {
       const container = document.querySelector('.songs-container');

       document.querySelectorAll('.song-item').forEach((item, idx) => {
       item.classList.toggle('active', idx === currentVideoIndex);

       if (idx === currentVideoIndex) {
       const itemTop = item.offsetTop;
       const itemHeight = item.offsetHeight;
       const containerHeight = container.clientHeight;

       container.scrollTo({
        top: itemTop - containerHeight / 2 + itemHeight / 2,
        behavior: 'smooth'
      });
    }
  });
}
    
    function playNextVideo() {
      if (currentPlaylist.length === 0) return;
      let nextIndex = (isLastVideoEnded || currentVideoIndex >= currentPlaylist.length - 1) ? 0 : currentVideoIndex + 1;
      playVideo(currentPlaylist[nextIndex].videoId, nextIndex);
    }
    
    function playPrevVideo() {
      if (currentPlaylist.length === 0) return;
      let prevIndex = (currentVideoIndex <= 0) ? currentPlaylist.length - 1 : currentVideoIndex - 1;
      playVideo(currentPlaylist[prevIndex].videoId, prevIndex);
    }
    
    document.addEventListener('keydown', (event) => {
      if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') return;
      if (event.key === 'ArrowLeft') { event.preventDefault(); playPrevVideo(); }
      if (event.key === 'ArrowRight') { event.preventDefault(); playNextVideo(); }
      if (event.key === ' ' && youtubePlayer) {
        event.preventDefault();
        const state = youtubePlayer.getPlayerState();
        if (state === YT.PlayerState.PLAYING) youtubePlayer.pauseVideo();
        else youtubePlayer.playVideo();
      }
    });
    
    document.addEventListener('touchstart', () => {}, { passive: true });


  </script>

</body>
</html>
